!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["minesweeperjs-ui"]=t():e["minesweeperjs-ui"]=t()}(self,(function(){return(()=>{"use strict";var e={220:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});const n=[{name:"Easy",x:8,y:8,mines:10},{name:"Medium",x:16,y:16,mines:40},{name:"Hard",x:30,y:16,mines:99}];class a{constructor(e,t){this.newGame=e,this.selectedDifficulty=n.findIndex((e=>e.name.toLowerCase()===(t??"").toLowerCase()))??0,this.difficulties=n}create(){const e=document.createElement("div");return e.classList.add("header","flex-container","align-center"),e.appendChild(this.createMetrics()),e.appendChild(this.createNewGameButton()),e.appendChild(this.createDifficultySelect()),e}createMetrics(){const e=document.createElement("div");e.classList.add("flex-container","align-center");const t=document.createElement("div");t.classList.add("mine"),t.innerHTML="&nbsp;",e.appendChild(t);const s=document.createElement("div");s.id="ms-js-mines",s.classList.add("padding-right","font-weight-bold"),s.innerHTML=(""+this.difficulties[this.selectedDifficulty].mines).padStart(2,"0"),e.appendChild(s);const n=document.createElement("div");n.classList.add("timer"),n.innerHTML="&nbsp;",e.appendChild(n);const a=document.createElement("div");return a.id="ms-js-timer",a.classList.add("padding-right","font-weight-bold"),a.innerHTML="000",e.appendChild(a),e}createNewGameButton(){const e=document.createElement("div");return e.id="ms-js-new-game",e.classList.add("new-game","padding-right"),e.addEventListener("click",(()=>{const t=this.difficulties[this.selectedDifficulty];this.newGame(t.x,t.y,t.mines),e.classList.remove("win","loss")})),e}createDifficultySelect(){const e=document.createElement("select");e.id="ms-js-difficulty";for(let t=0;t<this.difficulties.length;t++){let s=document.createElement("option");s.value=t,s.text=this.difficulties[t].name,t===this.selectedDifficulty&&s.setAttribute("selected",!0),e.appendChild(s)}return e.addEventListener("change",(()=>{const t=parseInt(e.value);if(t!==this.selectedDifficulty){const e=this.difficulties[t];this.newGame(e.x,e.y,e.mines),this.selectedDifficulty=t}})),e}}class i{constructor(e,t,s){this.solver=e,this.setClickable=t,this.setMineable=s}create(){const e=document.createElement("div");e.id="ms-js-solver",e.classList.add("solver");const t=document.createElement("div");t.classList.add("w-100");const s=document.createElement("button");s.setAttribute("type","button"),s.classList.add("solver-btn"),s.innerHTML="Help",t.appendChild(s);let n=[],a=0;s.addEventListener("click",(()=>{if(this.solver.game.over)return!1;this.solver.game.lastXPlayed===this.solver.lastXScouted&&this.solver.game.lastYPlayed===this.solver.lastYScouted||(n=this.solver.getAllPlays()),0===n.length?this.alertNoMoves():(a>=n.length&&(a=0),this.displayMove(n[a]),a++)})),e.appendChild(t);const i=document.createElement("div");i.id="ms-js-no-move-warning",i.classList.add("w-100","text-emphasize","padding-top"),e.appendChild(i);const l=document.createElement("div");l.id="ms-js-tip",l.classList.add("tip","flex-container");const d=document.createElement("div");d.id="ms-js-tip-board-state",l.appendChild(d);const c=document.createElement("div");c.id="ms-js-tip-pattern",l.appendChild(c);const r=document.createElement("div");return r.id="ms-js-tip-move",l.appendChild(r),e.appendChild(l),e}alertNoMoves(){document.getElementById("ms-js-no-move-warning").innerHTML="Not sure of any moves at the moment. Take a guess"}displayMove(e){const t=document.getElementById("ms-js-tip"),s=this.solver.rules.getRule(e.ruleKey);let n=3;s&&(n=s.pattern[0].length);let a=this.solver.getArea(e.x,e.y,n);if(t.replaceChild(this.createGameTemplate(a),document.getElementById("ms-js-tip-board-state")),s){let n=s.pattern,a=s.solution;for(let t=0;t<e.rotation;t++)n=this.solver.rules.rotate(n),a=this.solver.rules.rotate(a);t.replaceChild(this.createPatternTemplate(n,a),document.getElementById("ms-js-tip-pattern"))}else{const s=document.createElement("div");s.id="ms-js-tip-pattern";const n=document.createElement("h5");n.innerHTML="Rule #"+(e.ruleKey+3)+":",s.appendChild(n);const a=document.createElement("p");a.classList.add("text-sm","text-emphasize");const i=document.createElement("span");i.classList.add("font-weight-bold"),-2===e.ruleKey?(a.innerHTML="This space has the number of mines flagged in neighbors. ",i.innerHTML="Can click all unflagged neighbors."):(a.innerHTML="The number of unrevealed spaces equals this space. ",i.innerHTML="Can flag all neighbors."),a.appendChild(i),s.appendChild(a),t.replaceChild(s,document.getElementById("ms-js-tip-pattern"))}t.replaceChild(this.createMoveTemplate(a,e),document.getElementById("ms-js-tip-move")),this.addMoveToGameBoard(e)}addMoveToGameBoard(e){e.canClick.forEach((e=>{this.setClickable(e.x,e.y)})),e.canMine.forEach((e=>{this.setMineable(e.x,e.y)}));let t=document.getElementsByClassName("solver-focus");for(let e=0;e<t.length;e++)t[e].classList.remove("solver-focus");document.getElementById("ms-js-cell-"+e.x+"-"+e.y).classList.add("solver-focus")}createGameTemplate(e){const t=document.createElement("div");t.id="ms-js-tip-board-state";const s=document.createElement("h5");s.innerHTML="Board State:",t.appendChild(s);for(let s=0;s<e.length;s++){let n=document.createElement("tr");for(let t=0;t<e[s].length;t++){let a=document.createElement("td"),i=Math.floor(e.length/2);switch(t===Math.floor(e[s].length/2)&&s===i&&a.classList.add("solver-focus"),e[s][t]){case"E":a.classList.add("dead");break;case"?":a.classList.add("cell-btn");break;case"F":a.classList.add("cell-btn","flag");break;default:a.classList.add(this.getNumberClass(e[s][t]),"cell-btn","disabled"),e[s][t]>0&&(a.innerHTML=""+e[s][t])}n.appendChild(a)}t.appendChild(n)}return t}createPatternTemplate(e,t){const s=document.createElement("div");s.id="ms-js-tip-pattern";const n=document.createElement("h5");n.innerHTML="Pattern Match:",s.appendChild(n);for(let n=0;n<e.length;n++){let a=document.createElement("tr");for(let s=0;s<e[n].length;s++){let i=document.createElement("td"),l=Math.floor(e.length/2);switch(s===Math.floor(e[n].length/2)&&n===l&&i.classList.add("solver-focus"),e[n][s]){case" ":"+"===t[n][s]?i.classList.add("cell-btn","clickable"):"X"===t[n][s]?i.classList.add("cell-btn","mineable"):i.classList.add("dead");break;case"-":i.classList.add("cell-btn","zero","disabled");break;case"?":"+"===t[n][s]?i.classList.add("cell-btn","clickable"):"X"===t[n][s]?i.classList.add("cell-btn","mineable"):i.classList.add("cell-btn");break;case"F":i.classList.add("cell-btn","flag");break;default:i.classList.add(this.getNumberClass(e[n][s]),"cell-btn","disabled"),e[n][s]>0&&(i.innerHTML=""+e[n][s])}a.appendChild(i)}s.appendChild(a)}return s}createMoveTemplate(e,t){const s=document.createElement("div");s.id="ms-js-tip-move";const n=document.createElement("h5");n.innerHTML="Moves:",s.appendChild(n);for(let n=0;n<e.length;n++){let a=document.createElement("tr");for(let s=0;s<e[n].length;s++){let i=document.createElement("td"),l=Math.floor(e.length/2),d=Math.floor(e[n].length/2);switch(s===d&&n===l&&i.classList.add("solver-focus"),e[n][s]){case"E":i.classList.add("dead");break;case"?":t.canMine.find((e=>e.x-t.x+d===s&&e.y-t.y+l===n))?i.classList.add("cell-btn","mineable"):t.canClick.find((e=>e.x-t.x+d===s&&e.y-t.y+l===n))&&i.classList.add("cell-btn","clickable"),i.classList.add("cell-btn");break;case"F":i.classList.add("cell-btn, flag");break;default:i.classList.add(this.getNumberClass(e[n][s]),"cell-btn","disabled"),e[n][s]>0&&(i.innerHTML=""+e[n][s])}a.appendChild(i)}s.appendChild(a)}return s}getNumberClass(e){return["zero","one","two","three","four","five","six","seven","eight"][e]}}class l{constructor(e,t,s,n,a){this.game=e,this.announceOutcome=t,this.toggleTimer=s,this.setMineCount=n,this.clearAlert=a}create(){const e=document.createElement("table");e.id="ms-js-board",e.classList.add("board"),e.setAttribute("cellspacing","0"),e.setAttribute("cellpadding","0");for(let t=0;t<this.game.getLength();t++)e.appendChild(this.row(t));let t=null,s=!1,n=!1,a=!1,i=!1;e.addEventListener("contextmenu",(e=>(e.preventDefault(),!1))),e.addEventListener("mousewheel",(e=>(e.preventDefault(),!1))),e.addEventListener("mouseover",(e=>{e.target.classList.contains("cell-btn")&&(t=e.target,s&&n||i||s&&a?this.pressNeighbors(t):!s||t.classList.contains("disabled")||t.classList.contains("flag")||t.classList.add("active"))})),e.addEventListener("mouseout",(e=>{t=null,e.target.classList.contains("board")?(s=!1,n=!1):e.target.classList.contains("cell-btn")&&(s&&n||i||s&&a?this.unpressNeighbors(e.target):s&&e.target.classList.remove("active"))})),e.addEventListener("mousedown",(e=>{e.target.classList.contains("cell-btn")&&(0===e.button?s=!0:1===e.button?i=!0:2===e.button&&(n=!0),a=e.ctrlKey,s&&n||i||s&&a?this.pressNeighbors(t):!s||t.classList.contains("disabled")||t.classList.contains("flag")||t.classList.add("active"))}));let l=!0;return e.addEventListener("mouseup",(e=>{if(e.target.classList.contains("cell-btn"))return this.clearAlert(),l&&(l=!1,this.toggleTimer()),this.processClick(t,s,n,i,a),0===e.button?s=!1:1===e.button?i=!1:2===e.button&&(n=!1),a=e.ctrlKey,!1})),e}pressNeighbors(e){const t=parseInt(e.dataset.x),s=parseInt(e.dataset.y);this.getNeighbors(t,s).forEach((e=>{e.classList.contains("disabled")||e.classList.contains("flag")||e.classList.add("active")}))}unpressNeighbors(e){const t=parseInt(e.dataset.x),s=parseInt(e.dataset.y);this.getNeighbors(t,s).forEach((e=>{e.classList.remove("active")}))}getNeighbors(e,t){let s=[];for(let n=Math.max(0,t-1);n<Math.min(this.game.getLength(),t+2);n++)for(let t=Math.max(0,e-1);t<Math.min(this.game.getWidth(),e+2);t++)s.push(document.getElementById("ms-js-cell-"+t+"-"+n));return s}processClick(e,t,s,n,a){let i=[];const l=parseInt(e.dataset.x),d=parseInt(e.dataset.y);t&&s||n||t&&a?(this.unpressNeighbors(e),i=this.game.clearNeighbors(l,d)):t?e.classList.contains("disabled")||e.classList.contains("flag")||(i=this.game.click(l,d)):s&&(e.classList.contains("disabled")||(i=this.game.toggleFlag(l,d))),i.forEach((e=>{this.processOutcome(e)}))}processOutcome(e){if(e.state){if("LOSE"===e.state){document.getElementById("ms-js-cell-"+e.x+"-"+e.y).classList.add("mine","losing-move","disabled"),this.announceOutcome(!1)}else"WIN"===e.state&&this.announceOutcome(!0);this.toggleTimer()}else if("boolean"==typeof e.value)if(e.value){document.getElementById("ms-js-cell-"+e.x+"-"+e.y).classList.add("flag"),this.setMineCount("-")}else{document.getElementById("ms-js-cell-"+e.x+"-"+e.y).classList.remove("flag"),this.setMineCount("+")}else{let t=document.getElementById("ms-js-cell-"+e.x+"-"+e.y);"X"===e.value?t.classList.add("mine","disabled"):0===e.value?t.classList.add("zero","disabled"):(t.classList.add(this.getNumberClass(e.value),"disabled"),t.innerHTML=e.value)}}getNumberClass(e){return["zero","one","two","three","four","five","six","seven","eight"][e]}row(e){const t=document.createElement("tr");for(let s=0;s<this.game.getWidth();s++)t.appendChild(this.cell(s,e));return t}cell(e,t){const s=document.createElement("td");return s.id="ms-js-cell-"+e+"-"+t,s.dataset.x=e,s.dataset.y=t,s.classList="cell-btn",s}}class d{constructor(e,t,s){this.game=e,this.solver=t,this.difficulty=s}create(){this.headerUI=new a(this.newGame.bind(this),this.difficulty),this.gameUI=new l(this.game,this.announceOutcome,this.toggleTimer.bind(this),this.setMineCount,this.clearAlert),this.solver&&(this.solverUI=new i(this.solver,this.setClickable,this.setMineable));const e=document.createElement("div");e.classList.add("minesweeper-js");const t=document.createElement("div");if(t.id="ms-js-game-container",t.appendChild(this.headerUI.create()),t.appendChild(this.gameUI.create()),e.appendChild(t),this.solver){const t=document.createElement("div");t.id="ms-js-solver-container",t.appendChild(this.solverUI.create()),e.appendChild(t)}return e}newGame(e,t,s){this.game.newGame(e,t,s),document.getElementById("ms-js-game-container").replaceChild(this.gameUI.create(),document.getElementById("ms-js-board")),this.stopTimer(),this.setTime(0),this.setMineCount(s),this.solver&&(this.solver.newGame(this.game),document.getElementById("ms-js-solver-container").replaceChild(this.solverUI.create(),document.getElementById("ms-js-solver")))}announceOutcome(e){const t=document.getElementById("ms-js-new-game");e?t.classList.add("win"):t.classList.add("loss")}stopTimer(){this.timer&&(clearInterval(this.timer),this.timer=null)}toggleTimer(){this.timer?(clearInterval(this.timer),this.timer=null):(this.time=0,this.timer=setInterval((()=>{this.time++,this.setTime(this.time)}),1e3))}setTime(e){e>=999&&(e=999),document.getElementById("ms-js-timer").innerHTML=(""+e).padStart(3,"0")}setMineCount(e){const t=document.getElementById("ms-js-mines");"+"===e?e=parseInt(t.innerHTML)+1:"-"===e&&(e=parseInt(t.innerHTML)-1),t.innerHTML=(""+e).padStart(2,"0")}clearAlert(){document.getElementById("ms-js-no-move-warning").innerHTML=""}setClickable(e,t){let s=document.getElementById("ms-js-cell-"+e+"-"+t);s.classList.contains("disabled")||s.classList.add("clickable")}setMineable(e,t){const s=document.getElementById("ms-js-cell-"+e+"-"+t);s.classList.contains("disabled")||s.classList.add("mineable")}}}},t={};function s(n){if(t[n])return t[n].exports;var a=t[n]={exports:{}};return e[n](a,a.exports,s),a.exports}return s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s(220)})()}));